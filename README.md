# 自动探嗅接口变化

## 目标

探测接口变动，防止出现后端接口字段变更，而前端没有感知导致的异常；

变更包括：

- 探测接口是否还存在
- 探测接口中的字段是否有增减
- 探测接口中的字段类型是否变更

## 方案：部署脚本服务来定时监控数据是否变更

1. 确定监控的服务
1. 通过接口获取数据
1. 整理解析数据格式，拿到需要监控的数据
1. 拿到目标格式的字段，推理其中的类型类型
1. 第一次运行时，存一份快照到本地，用于对比
1. 之后每次运行时，对比快照，如果有变更，就报警并写下 diff 日志
1. 推送异常到钉钉

## 如何使用

```bash
# 启动测试服务器
yarn start-server

# 运行脚本
# help
node src/index.mjs --help
# 开始接口测试
node src/index.mjs run
# 更新本地快照
node src/index.mjs update
```
